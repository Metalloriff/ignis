{"ast":null,"code":"var _jsxFileName = \"D:\\\\Drive\\\\Shared\\\\JavaScript\\\\Electron\\\\ignis\\\\frontend\\\\src\\\\Components\\\\LauncherModal.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faFile, faFire, faFolder, faImage, faTerminal } from \"@fortawesome/free-solid-svg-icons\";\nimport Tooltip from \"./Tooltip\";\nimport Toasts, { Toast } from \"./Toasts\";\nimport IconFlat from \"../Icons/LogoFlat.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst commands = {\n  help: {\n    description: \"Lists all of the available commands.\"\n  },\n  js: {\n    description: \"Executes the specified arguments as JavaScript.\",\n    arguments: \"<code>\",\n    handle: (...args) => eval(args.join(\" \"))\n  }\n}; // Import the file system module\n\nconst fs = window.require(\"fs\"); // Import the path module\n\n\nconst path = window.require(\"path\"); // Get the child process module\n\n\nconst childProcess = window.require(\"child_process\"); // This is responsible for formatting paths to variable paths\n\n\nfunction getPathFromString(value) {\n  var _appdata$local$locala;\n\n  // Grab the electron process, not the renderer process\n  const process = window.require(\"process\"); // Split the path into directory sections\n\n\n  const pathSplit = value.split(\"/\"); // Get the root of the path based on some variables\n  // This might be the most incomprehensible line I've written in a while\n\n  const root = (_appdata$local$locala = {\n    appdata: process.env.APPDATA,\n    local: process.env.LOCALAPPDATA,\n    localappdata: process.env.LOCALAPPDATA,\n    home: process.env.HOMEPATH,\n    public: process.env.PUBLIC,\n    user: process.env.USERPROFILE,\n    programfiles86: process.env.ProgramFiles,\n    programfiles: process.env.ProgramW6432\n  }[pathSplit[0].toLowerCase().replaceAll(\"%\", \"\")]) !== null && _appdata$local$locala !== void 0 ? _appdata$local$locala : pathSplit[0]; // Return the path based on the root directory and the rest of the split path\n\n  return path.join(root, pathSplit.slice(1).join(\"/\")).replaceAll(\"\\\\\", \"/\");\n}\n\nexport default function LauncherModal() {\n  _s();\n\n  // Create the field ref\n  const fieldRef = React.useRef(); // Create our auto complete state\n\n  const [autoCompleteEntries, setAutoCompleteEntries] = React.useState([]); // Handle the send event\n\n  function handleSend(args) {\n    const _arguments = args.match(/[^\\s\"']+|\"([^\"]*)\"|'([^']*)'/gm); // Sent arguments was of type command, execute command if valid\n\n\n    if (args.startsWith(\"!\")) {\n      // Get the command object based on the first argument, lowercase, without the !\n      const command = commands[args.split(\" \")[0].slice(1).toLowerCase()]; // Command exists, execute it\n\n      if (command) {\n        // Call the command and get its return value\n        const response = command.handle(..._arguments.slice(1)); // Display our data to the user\n\n        response && Toasts.showToast(response.toString());\n        console.log(response);\n      } // Command does not exist, throw an error\n      else {\n        Toasts.showToast( /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [arguments[0].slice(1), \" is not a valid command\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 34\n        }, this), \"Failure\");\n      }\n    } // TODO check for indexed files\n    // If no commands or indexed files were found, try to launch manually\n    else {\n      // Try catch, in case of errors\n      try {\n        // Open the file, directory, or URL\n        childProcess.exec(`start \"\" \"${getPathFromString(args)}\"`); // Close the modal\n\n        window.close();\n      } // An error was caught, throw it to the console and warn the user\n      catch (e) {\n        console.error(e);\n        Toasts.showToast(\"Error opening file, check console for details\", \"Failure\");\n      }\n    } // Clear the field\n\n\n    fieldRef.current.value = \"\";\n  } // Handle rendering of auto-complete\n\n\n  function handleAutoComplete({\n    currentTarget: {\n      value\n    }\n  }) {\n    // TODO handle command auto complete\n    if (value.startsWith(\"!\")) {\n      const search = value.slice(1).toLowerCase();\n      const results = Object.keys(commands).filter(cmd => ~cmd.indexOf(search));\n      const components = [];\n\n      for (const result of results) {\n        const command = commands[result];\n        components.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"Item\",\n          onClick: () => fieldRef.current.value = \"!\" + result,\n          children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faTerminal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: [\"!\", result]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 31\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                opacity: 0.5\n              },\n              children: [\" - \", command.description]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 47\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 25\n          }, this)]\n        }, result, true, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this));\n        setAutoCompleteEntries(components);\n      }\n\n      return;\n    } // Put our raw path through the variable checks\n\n\n    const fpRaw = getPathFromString(value); // Get the second to last path entry, to exclude what we're searching\n\n    const fpDir = fpRaw.split(\"/\").slice(0, -1).join(\"/\"); // If the fp doesn't exist, but the dir does, set fp to dir\n\n    const fp = !fs.existsSync(fpRaw) && fs.existsSync(fpDir) ? fpDir : fpRaw; // dir exists, get its files\n\n    if (value && fs.existsSync(fp)) {\n      // Read all files in the directory, filtered by searching the final path entry\n      const files = fs.readdirSync(fp).filter(p => ~path.join(fp, p).toLowerCase().indexOf(fpRaw.split(\"/\").slice(-1)[0].toLowerCase())); // Map the first 10 files into auto complete entry components\n\n      const components = files.slice(0, 10).map(fn => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"Item\",\n        onClick: () => fieldRef.current.value = path.join(fp, fn),\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: fs.lstatSync(path.join(fp, fn)).isDirectory() ? faFolder : faFile\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: fn\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }, this)]\n      }, fn, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }, this)); // Set our entries to the components list\n\n      setAutoCompleteEntries(components);\n    } // If the directory doesn't exist, clear our entries\n    else setAutoCompleteEntries([]);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"LauncherModal\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Title\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        alt: \"Icon\",\n        src: IconFlat,\n        height: 20\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 17\n      }, this), \"Ignis Launcher\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Flex\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"LauncherModalField\",\n        ref: fieldRef,\n        onKeyDown: e => e.key === \"Enter\" && handleSend(e.currentTarget.value),\n        onChange: handleAutoComplete,\n        placeholder: \"Example - !help\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"Button\",\n        onClick: () => handleSend(fieldRef.current.value),\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faFire\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n          children: \"Run Command\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"AutoComplete\",\n      children: autoCompleteEntries\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 9\n  }, this);\n}\n\n_s(LauncherModal, \"ne/xbv//Q9Al/gHXU+ZYOVVwwxw=\");\n\n_c = LauncherModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"LauncherModal\");","map":{"version":3,"sources":["D:/Drive/Shared/JavaScript/Electron/ignis/frontend/src/Components/LauncherModal.js"],"names":["React","FontAwesomeIcon","faFile","faFire","faFolder","faImage","faTerminal","Tooltip","Toasts","Toast","IconFlat","commands","help","description","js","arguments","handle","args","eval","join","fs","window","require","path","childProcess","getPathFromString","value","process","pathSplit","split","root","appdata","env","APPDATA","local","LOCALAPPDATA","localappdata","home","HOMEPATH","public","PUBLIC","user","USERPROFILE","programfiles86","ProgramFiles","programfiles","ProgramW6432","toLowerCase","replaceAll","slice","LauncherModal","fieldRef","useRef","autoCompleteEntries","setAutoCompleteEntries","useState","handleSend","_arguments","match","startsWith","command","response","showToast","toString","console","log","exec","close","e","error","current","handleAutoComplete","currentTarget","search","results","Object","keys","filter","cmd","indexOf","components","result","push","opacity","fpRaw","fpDir","fp","existsSync","files","readdirSync","p","map","fn","lstatSync","isDirectory","key"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faFile, faFire, faFolder, faImage, faTerminal } from \"@fortawesome/free-solid-svg-icons\";\r\nimport Tooltip from \"./Tooltip\";\r\nimport Toasts, { Toast } from \"./Toasts\";\r\nimport IconFlat from \"../Icons/LogoFlat.png\";\r\n\r\nconst commands = {\r\n    help: {\r\n        description: \"Lists all of the available commands.\"\r\n    },\r\n    js: {\r\n        description: \"Executes the specified arguments as JavaScript.\",\r\n        arguments: \"<code>\",\r\n        handle: (...args) => eval(args.join(\" \"))\r\n    }\r\n};\r\n\r\n// Import the file system module\r\nconst fs = window.require(\"fs\");\r\n// Import the path module\r\nconst path = window.require(\"path\");\r\n// Get the child process module\r\nconst childProcess = window.require(\"child_process\");\r\n\r\n// This is responsible for formatting paths to variable paths\r\nfunction getPathFromString(value) {\r\n    // Grab the electron process, not the renderer process\r\n    const process = window.require(\"process\");\r\n    // Split the path into directory sections\r\n    const pathSplit = value.split(\"/\");\r\n\r\n    // Get the root of the path based on some variables\r\n    // This might be the most incomprehensible line I've written in a while\r\n    const root = {\r\n        appdata: process.env.APPDATA,\r\n        local: process.env.LOCALAPPDATA,\r\n        localappdata: process.env.LOCALAPPDATA,\r\n        home: process.env.HOMEPATH,\r\n        public: process.env.PUBLIC,\r\n        user: process.env.USERPROFILE,\r\n        programfiles86: process.env.ProgramFiles,\r\n        programfiles: process.env.ProgramW6432\r\n    }[pathSplit[0].toLowerCase().replaceAll(\"%\", \"\")] ?? pathSplit[0];\r\n\r\n    // Return the path based on the root directory and the rest of the split path\r\n    return path.join(root, pathSplit.slice(1).join(\"/\")).replaceAll(\"\\\\\", \"/\");\r\n}\r\n\r\nexport default function LauncherModal() {\r\n    // Create the field ref\r\n    const fieldRef = React.useRef();\r\n    // Create our auto complete state\r\n    const [autoCompleteEntries, setAutoCompleteEntries] = React.useState([]);\r\n    \r\n    // Handle the send event\r\n    function handleSend(args) {\r\n        const _arguments = args.match(/[^\\s\"']+|\"([^\"]*)\"|'([^']*)'/gm);\r\n        \r\n        // Sent arguments was of type command, execute command if valid\r\n        if (args.startsWith(\"!\")) {\r\n            // Get the command object based on the first argument, lowercase, without the !\r\n            const command = commands[args.split(\" \")[0].slice(1).toLowerCase()];\r\n            \r\n            // Command exists, execute it\r\n            if (command) {\r\n                // Call the command and get its return value\r\n                const response = command.handle(..._arguments.slice(1));\r\n                \r\n                // Display our data to the user\r\n                response && Toasts.showToast(response.toString());\r\n                console.log(response);\r\n            }\r\n            // Command does not exist, throw an error\r\n            else {\r\n                Toasts.showToast(<span>{arguments[0].slice(1)} is not a valid command</span>, \"Failure\");\r\n            }\r\n        }\r\n        // TODO check for indexed files\r\n        // If no commands or indexed files were found, try to launch manually\r\n        else {\r\n            // Try catch, in case of errors\r\n            try {\r\n                // Open the file, directory, or URL\r\n                childProcess.exec(`start \"\" \"${getPathFromString(args)}\"`);\r\n\r\n                // Close the modal\r\n                window.close();\r\n            }\r\n            // An error was caught, throw it to the console and warn the user\r\n            catch (e) {\r\n                console.error(e);\r\n                Toasts.showToast(\"Error opening file, check console for details\", \"Failure\");\r\n            }\r\n        }\r\n        \r\n        // Clear the field\r\n        fieldRef.current.value = \"\";\r\n    }\r\n    \r\n    // Handle rendering of auto-complete\r\n    function handleAutoComplete({ currentTarget: { value } }) {\r\n        // TODO handle command auto complete\r\n        if (value.startsWith(\"!\")) {\r\n            const search = value.slice(1).toLowerCase();\r\n            const results = Object.keys(commands).filter(cmd => ~cmd.indexOf(search));\r\n            const components = [];\r\n            \r\n            for (const result of results) {\r\n                const command = commands[result];\r\n                \r\n                components.push(\r\n                    <div className=\"Item\" key={result} onClick={() => fieldRef.current.value = \"!\" + result}>\r\n                        <FontAwesomeIcon icon={faTerminal}/>\r\n                        \r\n                        <span><b>!{result}</b><span style={{ opacity: 0.5 }}> - {command.description}</span></span>\r\n                    </div>\r\n                );\r\n                \r\n                setAutoCompleteEntries(components);\r\n            }\r\n            \r\n            return;\r\n        }\r\n        \r\n        // Put our raw path through the variable checks\r\n        const fpRaw = getPathFromString(value);\r\n        // Get the second to last path entry, to exclude what we're searching\r\n        const fpDir = fpRaw.split(\"/\").slice(0, -1).join(\"/\");\r\n        // If the fp doesn't exist, but the dir does, set fp to dir\r\n        const fp = !fs.existsSync(fpRaw) && fs.existsSync(fpDir) ? fpDir : fpRaw;\r\n        \r\n        // dir exists, get its files\r\n        if (value && fs.existsSync(fp)) {\r\n            // Read all files in the directory, filtered by searching the final path entry\r\n            const files = fs.readdirSync(fp).filter(p =>\r\n                ~path.join(fp, p).toLowerCase().indexOf(fpRaw.split(\"/\").slice(-1)[0].toLowerCase()));\r\n            // Map the first 10 files into auto complete entry components\r\n            const components = files.slice(0, 10).map(fn => (\r\n                <div className=\"Item\" key={fn} onClick={() => fieldRef.current.value = path.join(fp, fn)}>\r\n                    <FontAwesomeIcon icon={fs.lstatSync(path.join(fp, fn)).isDirectory()\r\n                        ? faFolder : faFile}/>\r\n                    \r\n                    <span>{fn}</span>\r\n                </div>\r\n            ));\r\n            \r\n            // Set our entries to the components list\r\n            setAutoCompleteEntries(components);\r\n        }\r\n        // If the directory doesn't exist, clear our entries\r\n        else setAutoCompleteEntries([]);\r\n    }\r\n    \r\n    return (\r\n        <div className=\"LauncherModal\">\r\n            <div className=\"Title\">\r\n                <img alt=\"Icon\" src={IconFlat} height={20}/>\r\n                \r\n                Ignis Launcher\r\n            </div>\r\n\r\n            <div className=\"Flex\">\r\n                <input className=\"LauncherModalField\" ref={fieldRef}\r\n                       onKeyDown={e => e.key === \"Enter\" && handleSend(e.currentTarget.value)}\r\n                       onChange={handleAutoComplete}\r\n                       placeholder=\"Example - !help\"/>\r\n\r\n                <div className=\"Button\" onClick={() => handleSend(fieldRef.current.value)}>\r\n                    <FontAwesomeIcon icon={faFire}/>\r\n                    \r\n                    <Tooltip>\r\n                        Run Command\r\n                    </Tooltip>\r\n                </div>\r\n            </div>\r\n            \r\n            <div className=\"AutoComplete\">\r\n                {autoCompleteEntries}\r\n            </div>\r\n        </div>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}